{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Phishbuster</title>
  
  <meta content="" name="description">
  <meta content="" name="keywords">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <!-- Favicons -->
  <link href="{% static '/assets/img/mainlogo.jpeg' %}" rel="icon">
  <link href="{% static 'assets/img/mainlogo.jpeg' %}" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Krub:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/css/bootstrap-extended.min.css">
<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/fonts/simple-line-icons/style.min.css">
<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/css/colors.min.css">
<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/css/bootstrap.min.css">
<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/icofont/icofont.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/boxicons/css/boxicons.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/owl.carousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/venobox/venobox.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/aos/aos.css' %}" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">
</head>

<body>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center">

      <h1 class="logo mr-auto"><a href="/">PhishB</a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo mr-auto"><img src="assets/img/mainlogo.jpeg" alt="" class="img-fluid"></a>-->

      <nav class="nav-menu d-none d-lg-block">
        <ul>
          <li class="active"><a href="/">Home</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="/usecases" target="_blank" rel="no-openner no-referrer">Usecases</a></li>
          <li class="drop-down"><a href="/info">Resources</a>
            <ul>
              <li class="drop-down"><a href="#">Report Phishing Cases</a>
                <ul>
                  <li><a href="https://safebrowsing.google.com/safebrowsing/report_phish/?hl=en">Google Safe
                      Browsing</a></li>
                  <li><a href="https://support.google.com/websearch/answer/106318">Google Support</a></li>
                </ul>
              </li>
              <li class="drop-down"><a href="#">Phishing Websites</a>
                <ul>
                  <li><a href="https://www.phishingbox.com/phishing-iq-test">Phishingbox</a></li>
                  <li><a href="https://www.intradyn.com/phishing-quiz/">Intradyn</a></li>
                  <!-- <li><a href="https://vadasecure.com/en/blog/anatomy-of-a-phishing-email">Vadasecure</a></li> -->
                </ul>
              </li>
              <!-- <li><a href="#">For Future Reference</a></li> -->
            </ul>
          </li>
          <li class="drop-down"><a>Profile</a>
            <ul>
            <li><a href="/profile">View Profile</a></li>
            <li><a href="/signout">Logout</a></li>
            </ul>
          </li>
          <!-- <li><a href="#">Future Reference</a></li> -->

        </ul>
      </nav><!-- .nav-menu -->

      <a href="{% static 'assets/resources/no fall maga cyber security eBook.pdf' %}" class="get-started-btn scrollto"
        download="nofallmagaguide">Download Guide <i class='bx bxs-download'></i></a>

    </div>
  </header><!-- End Header -->

  <!-- ======= Hero Section ======= -->
  <section id="hero" class="d-flex align-items-center">

    <div class="container d-flex flex-column align-items-center justify-content-center" data-aos="fade-up">
      <h1>.Phishbuster</h1>
      <form action="{% url 'predict' %}" method="post" role="form" class="form">
        {% csrf_token %}
        <div class="row no-gutters">
          <div class="col-md-6 form-group pr-md-1">
            <input type="text" name="url" class="form-control" id="url"
              placeholder="Enter a URL link in format http or https and should contain www">
          </div>
        </div>
        <div class="text-center">
          <button id="predict" class="btn btn-danger" onclick="predictURL()" type="button">Predict</button>
          <button id="reset" class="btn btn-primary" onclick="resetPage()" type="button">Reset</button>
        </div>
      </form>
      <div id="prediction-result" class="mt-3"></div>
      
    </div>

  </section><!-- End Hero -->

  <!-- ======= Frequently Asked Questions Section ======= -->
  <section id="faq" class="faq">
    <h2 class="text-center"><b>EXTRACTION FEATURES</b></h2>
    <div class="container" data-aos="fade-up">

      <div class="faq-list">
        <ul>
          <li data-aos="fade-up" data-aos="fade-up" data-aos-delay="100">
            <i class="bx bx-help-circle icon-help"></i> <a id="domain" data-toggle="collapse" class="collapse"
              href="#faq-list-1">Domain <i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-1" class="collapse show" data-parent=".faq-list">
              <p>
                Domain name system e.g facebook.com, bowen.edu.ng
              </p>
            </div>
          </li>

          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="have_ip" data-toggle="collapse" href="#faq-list-2"
              class="collapsed">Have_IP <i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-2" class="collapse" data-parent=".faq-list">
              <p>
                If an IP address is used as an alternative of the domain name in the URL, such as
                “http://125.98.3.123/fake.html

              </p>
            </div>
          </li>

          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="have_at" data-toggle="collapse" href="#faq-list-3"
              class="collapsed">Have_At<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-3" class="collapse" data-parent=".faq-list">
              <p>
                Using “@” symbol in the URL leads the browser to ignore everything preceding the “@” symbol and the real
                address often follows the “@” symbol
              </p>
            </div>
          </li>

          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="url_length" data-toggle="collapse" href="#faq-list-4"
              class="collapsed">URL_Length<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-4" class="collapse" data-parent=".faq-list">
              <p>

                URL length<54 → feature=Legitimate@ else if URL length≥54 and ≤75 → feature=Suspicious @otherwise→
                  feature=Phishing </p>
            </div>
          </li>

          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="url_depth" data-toggle="collapse" href="#faq-list-5"
              class="collapsed">URL_Depth<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-5" class="collapse" data-parent=".faq-list">
              <p>
                Let us assume we have the following link: http://www.hud.ac.uk/students/.) the .ac, .uk, /students are
                subdomains. Also, if the number of dots is greater than one, then the URL is classified as “Suspicious”
                since it has one sub domain. However, if the dots are greater than two, it is classified as “Phishing”
                since it will have multiple sub domains
              </p>
            </div>
          </li>

          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="redirection" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Redirection<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                a legitimate websites will be redirected one time max. On the other hand, phishing websites containing
                this feature have been redirected at least 4 times.
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="http_domain" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">HTTP_DOMAIN<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                The existence of HTTPS is very important in giving the impression of website legitimacy that is if a
                Website has Https or not
              </p>
            </div>
          </li>

          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="tiny_url" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">TinyURL<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                it means a domain name that is short, which links to the webpage that has a long URL. For example, the
                URL “http://portal.hud.ac.uk/” can be shortened to “bit.ly/19DXSk4”.} which can be Phishing
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="pre_suf" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Prefix/Suffix<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                Phishers tend to add prefixes or suffixes separated by (-) to the domain name so that users feel that
                they are dealing with a legitimate webpage. For example http://www.Confirme-paypal.com/
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="dns_record" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">DNS_Record<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                If the DNS record is empty or not found then the website is classified as “Phishing”, otherwise it is
                classified as “Legitimate”.
              </p>
            </div>
          </li>
          
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="domain_age" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Domain_Age<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                Most phishing websites live for a short period of time. By reviewing our dataset, we find that the minimum age of the legitimate domain is 6 months. }
                (Age Of Domain≥6 months → Legitimate@Otherwise → Phishing)
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="domain_end" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Domain_End<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                (Domain Registration Length)
                █(Domains Expires on≤ 1 years → Phishing@Otherwise→ Legitimate)                
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="iframe" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">iFrame<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                IFrame is an HTML tag used to display an additional webpage into one that is currently shown. Phishers can make use of the “iframe” tag and make it invisible }
                {(Using iframe→ Phishing@Otherwise → Legitimate)                             
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="mouse_over" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Mouse_Over<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                {Phishers may use JavaScript to show a fake URL in the status bar to users. To extract this feature, we must dig-out the webpage source code, particularly the “onMouseOver” event, and check if it makes any changes on the status bar. }
                Rule: IF{█(onMouseOver Changes Status Bar→ Phishing@It Does't Change Status Bar→Legitimate)                    
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="right_click" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Right_Click<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                Phishers use JavaScript to disable the right-click function, so that users cannot view and save the webpage source code. This feature is treated exactly as “Using onMouseOver to hide the Link”. Nonetheless, for this feature, we will search for event “event.button==2” in the webpage source code and check if the right click is disabled. 
                Rule: IF{(Right Click Disabled → Phishing @Otherwise→Legitimate)
              </p>
            </div>
          </li>
          <li data-aos="fade-up" data-aos-delay="200">
            <i class="bx bx-help-circle icon-help"></i> <a id="web_forwards" data-toggle="collapse" href="#faq-list-6"
              class="collapsed">Web_Forwards<i class="bx bx-chevron-down icon-show"></i><i
                class="bx bx-chevron-up icon-close"></i></a>
            <div id="faq-list-6" class="collapse" data-parent=".faq-list">
              <p>
                Submitting Information to Email
                Web form allows a user to submit his personal information that is directed to a server for processing. A phisher might redirect the user’s information to his personal email. To that end, a server-side script language might be used such as “mail()” function in PHP. One more client-side function that might be used for this purpose is the “mailto:” function. 
                (Using ""mail()\" or \"mailto:\" Function to Submit User Information" → Phishing@Otherwise  → Legitimate)
              </p>
            </div>
          </li>
         
        </ul>
      </div>

    </div>
  </section><!-- End Frequently Asked Questions Section -->

  <main id="main">

    <!-- ======= about Section ======= -->
    <section id="about" class="about">
      <div class="container" data-aos="fade-up">

        <div class="section-title">
          <h2>About Phishbuster</h2>
          <p>Phishbuster is a project that came into existence from a final year project “Detection of Phishing Website
            Using Machine Learning” carried out at Bowen University.
            It aims to help reduce phishing attack by helping internet users authenticate URL link by testing if it is
            phishing or legitimate. The progress of validating a Website URL for phishing or legitimate has gone through
            several Machine learning models.
          </p>

          <h3>About the Author</h3>
          <p>The Author of this Research is Adediran Goodness who is a Final Year Student of Computer Science and
            Information Technology at Bowen University who aspire to further his Career into Cyber Security. </p>
        </div>

      </div>
    </section><!-- End about Section -->

    <!-- ======= Testimonials Section ======= -->
    <section id="testimonials" class="testimonials section-bg">
      <div class="container" data-aos="fade-up">

        <div class="owl-carousel testimonials-carousel">

          <div class="testimonial-item">
            <p>
              <iframe width="400" height="409" src="https://www.youtube.com/embed/PWVN3Rq4gzw"
                title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </p>
          </div>

          <div class="testimonial-item">
            <p>
              <iframe width="400" height="409" src="https://www.youtube.com/embed//xuYoMs6CLEw"
                title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </p>
          </div>

        </div>

      </div>
    </section><!-- End Testimonials Section -->


  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container d-md-flex py-4">

      <div class="text-center text-md-center">
        <div class="copyright">
          <img src="{% static 'assets/img/google.png' %}" alt="">
          <a href="https://phishingquiz.withgoogle.com/" class="get-started-btn scrollto">Take a Phishing Test by
            GOOGLE</a> <br>
            <hr/> <a href="{% static 'assets/resources/my_work.7Z' %}" class="get-started-btn scrollto" download="my_work">Project Work <i class='bx bxs-download'></i></a>
          <p style="padding-top: 8px; font-weight: 600;">Final Year Project &copy; 2021.All Rights Reserved</p>
        </div>
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>
  <!-- <div id="preloader"></div> -->

  <!-- Vendor JS Files -->
  <script src="{% static 'assets/vendor/jquery/jquery.min.js' %}"></script>
  <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'assets/vendor/jquery.easing/jquery.easing.min.js' %}"></script>
  <script src="{% static 'assets/vendor/php-email-form/validate.js' %}"></script>
  <script src="{% static 'assets/vendor/owl.carousel/owl.carousel.min.js' %}"></script>
  <script src="{% static 'assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
  <script src="{% static 'assets/vendor/venobox/venobox.min.js' %}"></script>
  <script src="{% static 'assets/vendor/aos/aos.js' %}"></script>

  <!-- Template Main JS File -->
  <script src="{% static 'assets/js/main.js' %}"></script>
  <script>
    let predictedURL = "";
    function predictURL() {
      var url = document.getElementById('url').value;
      predictedURL = url;
      if (url == "") {
        alert("ENTER A URL");
      } else {
        if (url.includes("http") || url.includes("www")) {
          document.getElementById("predict").innerHTML = "Predicting ..."
          var csrftoken = getCookie('csrftoken');

          fetch("http://127.0.0.1:8000/predict", {
            method: "POST",
            headers: {
              Accept: "application/json",
              "Content-type": "application/json",
              "X-CSRFToken": csrftoken,
            },
            body: JSON.stringify({
              url: url
            }),
          })
            .then((res) => res.json())
            .then((data) => {
              if (data.success) {
                document.getElementById("predict").innerHTML = "Predicted"
                document.getElementById("predict").class = "btn btn-success"

                
                var predictionResult = document.getElementById("prediction-result");
                if (data.prediction == 0) {
                    predictionResult.innerHTML = '<span class="badge text-bg-success">Legitimate</span>';
                } 
                if (data.prediction == 1){
                    predictionResult.innerHTML = '<span class="badge text-bg-danger">Phishing</span><a href="https://safebrowsing.google.com/safebrowsing/report_phish/?hl=en"> <button type="button" onclick="reportPhishing()" class="btn btn-link">Report</button></a>';
                }
                var riskScore = data.risk_score;
                var ip = data.ip_address;
                var domain_rank = data.domain_rank;
                var root_domain = data.root_domain;
                var category = data.category;
                var additionalContent = document.createElement('div');
                
                additionalContent.style.display = 'flex';
                additionalContent.style.marginRight = '15px';
                    additionalContent.innerHTML = `
                    <div class="card" style="top:20px;margin-right: 15px; " data-toggle="popover"  data-placement="bottom" title="The risk score which estimates the confidence level for malicious URL detection. Risk Scores 85+ are high risk, while Risk Scores = 100 are confirmed as accurate." data-content="Risk score is ${riskScore}">
                            <div class="card-content" >
                              
                                <div class="card-body" >
                                    <div class="media d-flex">
                                        <div class="media-body text-left">
                                            <h3 class="success">${riskScore}</h3>
                                            <span>Risk score</span>
                                        </div>
                                        <div class="align-self-center" style="margin-left:20px;">
                                            <i class="icon-cup success font-large-2 float-right"></i>
                                        </div>
                                    </div>
                                    <div class="progress mt-1 mb-0" style="height: 7px;">
                                        <div class="progress-bar bg-success" role="progressbar" style="width: ${riskScore}%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card" style="top:20px;margin-right: 15px;" data-toggle="popover"  data-placement="bottom" title="Parent domain to identify the root level domain of the final destination URL." data-content="Risk score is ${riskScore}">
                          <div class="card-content" >
                              <div class="card-body" >
                                  <div class="media d-flex">
                                      <div class="media-body text-left">
                                          <h5 class="success">${root_domain}</h5>
                                          <span>Root Domain</span>
                                      </div>
                                      <div class="align-self-center" style="margin-left:20px;">
                                          <i class="icon-cup success font-large-2 float-right"></i>
                                      </div>
                                  </div>
                                  
                              </div>
                          </div>
                      </div>

                      <div class="card" style="top:20px;margin-right: 15px;" data-toggle="popover"  data-placement="bottom" title="Website classification and category related to the content and industry of the site." data-content="Risk score is ${riskScore}">
                        <div class="card-content" >
                            <div class="card-body" >
                                <div class="media d-flex">
                                    <div class="media-body text-left">
                                        <h3 class="success">${category}</h3>
                                        <span>Category</span>
                                    </div>
                                    <div class="align-self-center" style="margin-left:20px;">
                                        <i class="icon-cup success font-large-2 float-right"></i>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>

                        
                        <div class="card" style="top:20px;margin-right: 15px;" data-toggle="popover"  data-placement="bottom" title="Estimated popularity rank of website globally." data-content="Risk score is ${riskScore}">
                          <div class="card-content" >
                              <div class="card-body" >
                                  <div class="media d-flex">
                                      <div class="media-body text-left">
                                          <h3 class="success">${domain_rank}</h3>
                                          <span>Domain rank</span>
                                      </div>
                                      <div class="align-self-center" style="margin-left:20px;">
                                          <i class="icon-cup success font-large-2 float-right"></i>
                                      </div>
                                  </div>
                                  
                              </div>
                          </div>
                      </div>
                      
                          <div class="card" style="top:20px;" data-toggle="popover"  data-placement="bottom" title="The IP address corresponding to the server of the domain name." data-content="Risk score is ${riskScore}">
                            <div class="card-content">
                              <div class="card-body">
                                <div class="media d-flex">
                                  <div class="media-body text-left">
                                    <h3 class="primary">${ip}</h3>
                                    <span>Domain IP</span>
                                  </div>
                                  <div class="align-self-center" style="margin-left:20px;">
                                    <i class="icon-support primary font-large-2 float-right"></i>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      `;
                    predictionResult.appendChild(additionalContent);

                    $(function () {
                      $('[data-toggle="popover"]').popover();
                  });
                
                // DOMAIN
                document.getElementById("domain").innerHTML += `<span class="badge badge-primary" style="margin-left: 20px;">${data.detection[0]}</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                // URL DEPTH
                document.getElementById("url_depth").innerHTML += `<span class="badge badge-primary" style="margin-left: 20px;">has ${data.detection[4]} Subfolder</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                if (data.detection[4] > 1) {
                  document.getElementById("url_depth").innerHTML += `<span class="badge badge-warning" style="margin-left: 20px;">Suspension</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }
                if (data.detection[4] > 2) {
                  document.getElementById("url_depth").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`


                }  else {
                  document.getElementById("url_depth").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }





                // OTHERS
                if (data.detection[1] == 0) {
                  document.getElementById("have_ip").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("have_ip").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }

                if (data.detection[2] == 0) {
                  document.getElementById("have_at").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("have_at").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }

                if (data.detection[3] == 0) {
                  document.getElementById("url_length").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("url_length").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }

                if (data.detection[5] == 0) {
                  document.getElementById("redirection").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("redirection").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }

                if (data.detection[6] == 0) {
                  document.getElementById("http_domain").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("http_domain").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }
                if (data.detection[7] == 0) {
                  document.getElementById("tiny_url").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("tiny_url").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }
                if (data.detection[8] == 0) {
                  document.getElementById("pre_suf").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("pre_suf").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }
                
                if (data.detection[9] == 0) {
                  document.getElementById("dns_record").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("dns_record").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                }


                if (data.detection[10] == 0) {
                  document.getElementById("domain_age").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("domain_age").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                }

                if (data.detection[11] == 0) {
                  document.getElementById("domain_end").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("domain_end").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                }

                if (data.detection[12] == 0) {
                  document.getElementById("iframe").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("iframe").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                }

                if (data.detection[13] == 0) {
                  document.getElementById("mouse_over").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("mouse_over").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                }

                if (data.detection[14] == 0) {
                  document.getElementById("right_click").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("right_click").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                }

                if (data.detection[15] == 0) {
                  document.getElementById("web_forwards").innerHTML += `<span class="badge badge-success" style="margin-left: 20px;">Legit</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`

                } else {
                  document.getElementById("web_forwards").innerHTML += `<span class="badge badge-danger" style="margin-left: 20px;">Phishing</span><i class="bx bx-chevron-down icon-show"></i><i class="bx bx-chevron-up icon-close"></i>`
                }
                


              }
            })
            .catch((err) => console.log("not working"));
        } else {
          alert("URL MUST CONTAIN WWW AND HTTPS OR HTTP");
        }
      }



    }

    function reportPhishing() {
      // Make an AJAX request to the Django view with the predicted URL data
      var csrftoken = getCookie('csrftoken');
      fetch("http://127.0.0.1:8000/reporturl", {
          method: 'POST',
          headers: {
            Accept: "application/json",
              'Content-Type': 'application/json',
              'X-CSRFToken': csrftoken, // Ensure CSRF token is included
          },
          body: JSON.stringify({ url: predictedURL }), // Send predicted URL data in JSON format
      })
      .then(response => {
          if (!response.ok) {
              throw new Error('Failed to report phishing');
          }
          // Redirect the user to the Safe Browsing report page
          
      })
      .catch(error => {
          console.error('Error reporting phishing:', error.message);
      });
  }


    function getCookie(name) {
      var cookieValue = null;
      if (document.cookie && document.cookie !== '') {
          var cookies = document.cookie.split(';');
          for (var i = 0; i < cookies.length; i++) {
              var cookie = cookies[i].trim();
              if (cookie.substring(0, name.length + 1) === (name + '=')) {
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue;
  }


    function resetPage() {
      console.log("HELLO");
      location.reload();
    }
  </script>

</body>

</html>